#!/bin/bash

PROFILE="$(gum choose --select-if-one $(aws configure list-profiles))"

REGISTRY_ID="$(aws ecr describe-registry --profile $PROFILE | jq -r .registryId)"
REGION="$(aws configure get region --profile $PROFILE)"
REGISTRY_URL="${REGISTRY_ID}.dkr.ecr.${REGION}.amazonaws.com"

aws ecr get-login-password --profile $PROFILE | docker login --username AWS --password-stdin $REGISTRY_URL
